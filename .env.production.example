# Sample Solution - Production Environment Configuration
# This file is auto-generated by the Proxmox installation script
# The script replaces YOUR_VM_IP with your container's actual IP address

# ===========================================
# Server Configuration
# ===========================================
# YOUR_VM_IP will be automatically replaced during installation

# Frontend API URL (used by the React app to connect to backend)
API_URL=http://YOUR_VM_IP:4000

# Frontend URL (used by backend for CORS and redirects)
FRONTEND_URL=http://YOUR_VM_IP:3000
# Backend URL (used by backend for OAuth callbacks)
BACKEND_URL=http://YOUR_VM_IP:4000

# ===========================================
# Google OAuth & YouTube API
# ===========================================
# Get these credentials from Google Cloud Console (https://console.cloud.google.com)
#
# IMPORTANT - Google OAuth Setup for Proxmox:
# Google OAuth REQUIRES one of these for redirect URIs:
#   1. localhost (for local development only)
#   2. A registered .com/.org/etc domain name
#   3. A public IP address
#
# Private IPs (192.168.x.x, 10.x.x.x) are NOT accepted by Google!
#
# WORKAROUND OPTIONS:
#
# Option A - Use nip.io domain service (RECOMMENDED for local networks):
#   - nip.io provides DNS that resolves to your IP automatically
#   - If your Proxmox IP is 192.168.1.100, use: 192-168-1-100.nip.io
#   - Replace YOUR_VM_IP with: 192-168-1-100.nip.io (adjust for your IP)
#   - Add to Google Cloud Console: http://192-168-1-100.nip.io:4000/api/auth/google/callback
#   - Access your app at: http://192-168-1-100.nip.io:3000
#   - This works because Google accepts .io domains!
#
# Option B - Use your Proxmox host's public IP (if available):
#   - Replace YOUR_VM_IP below with your public IP
#   - Add to Google Cloud Console: http://YOUR_PUBLIC_IP:4000/api/auth/google/callback
#
# Option C - Use your own custom domain (for production):
#   - Point a domain (e.g., myapp.example.com) to your Proxmox IP
#   - Replace YOUR_VM_IP with your domain name
#   - Add to Google Cloud Console: http://myapp.example.com:4000/api/auth/google/callback
#
# Option D - Port forward to localhost (for development):
#   - Set up SSH port forwarding: ssh -L 3000:PROXMOX_IP:3000 -L 4000:PROXMOX_IP:4000 user@proxmox
#   - Use localhost URLs instead of YOUR_VM_IP
#   - Add to Google Cloud Console: http://localhost:4000/api/auth/google/callback

GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-client-secret
GOOGLE_REDIRECT_URI=http://YOUR_VM_IP:4000/api/auth/google/callback
YOUTUBE_API_KEY=your-youtube-api-key

# ===========================================
# Spotify OAuth (Optional - for account playlists / private playlists)
# ===========================================
# Create an app in Spotify Developer Dashboard:
#   https://developer.spotify.com/dashboard
# Add redirect URI in your Spotify app settings:
#   http://YOUR_VM_IP:4000/api/spotify/callback
# (or your domain-based BACKEND_URL equivalent)
SPOTIFY_CLIENT_ID=your-spotify-client-id
SPOTIFY_CLIENT_SECRET=your-spotify-client-secret

# ===========================================
# Security
# ===========================================
# Generate a strong random string for session security
# You can generate one with: openssl rand -base64 32

SESSION_SECRET=CHANGE-THIS-TO-A-LONG-RANDOM-STRING

# ===========================================
# Optional Configuration
# ===========================================

# Node environment (keep as production)
NODE_ENV=production

# Server port (default: 4000)
# PORT=4000

# Data directory (default: /app/data)
# DATA_DIR=/app/data

# Ollama host (default: http://ollama:11434)
# OLLAMA_HOST=http://ollama:11434
# Ollama model to auto-pull at startup (default: llama3.2:3b)
# OLLAMA_MODEL=llama3.2:3b
# Dedicated analyzer Ollama host/model for post-analysis tag QA.
# Defaults to a cloned service in docker-compose and falls back to primary in backend code.
# OLLAMA_ANALYZER_HOST=http://ollama-analyzer:11434
# OLLAMA_ANALYZER_MODEL=${OLLAMA_MODEL}
# CPU fallback Ollama host/model for tag QA chain.
# OLLAMA_CPU_HOST=http://ollama:11434
# OLLAMA_CPU_MODEL=${OLLAMA_MODEL}
# Optional analyzer concurrency/failure controls (fallback to primary values):
# OLLAMA_ANALYZER_MAX_CONCURRENT_GENERATE=1
# OLLAMA_ANALYZER_GENERATE_FAILURE_THRESHOLD=2
# OLLAMA_ANALYZER_GENERATE_FAILURE_COOLDOWN_MS=30000
# Optional cpu-target concurrency/failure controls (fallback to primary values):
# OLLAMA_CPU_MAX_CONCURRENT_GENERATE=1
# OLLAMA_CPU_GENERATE_FAILURE_THRESHOLD=2
# OLLAMA_CPU_GENERATE_FAILURE_COOLDOWN_MS=30000
# Post-analysis tag QA fallback chain and retry policy:
# OLLAMA_TAG_REVIEW_TARGET_CHAIN=analyzer,primary,cpu
# OLLAMA_TAG_REVIEW_RETRIES_PER_TARGET=1
# OLLAMA_TAG_REVIEW_RETRY_DELAY_MS=200
# OLLAMA_TAG_REVIEW_HEALTH_TIMEOUT_MS=800
# Batch review timeout for grouped review calls (default: 90000)
# OLLAMA_TAG_REVIEW_BATCH_TIMEOUT_MS=90000
# Final post-analysis audit chain and retry policy (largest model first by default):
# OLLAMA_TAG_AUDIT_TARGET_CHAIN=primary,analyzer,cpu
# OLLAMA_TAG_AUDIT_RETRIES_PER_TARGET=1
# OLLAMA_TAG_AUDIT_RETRY_DELAY_MS=200
# OLLAMA_TAG_AUDIT_HEALTH_TIMEOUT_MS=800
# OLLAMA_TAG_AUDIT_TIMEOUT_MS=90000
# Enable post-analysis Ollama review (1=true, 0=false)
# OLLAMA_TAG_REVIEW=1
# Batch re-analyze final audit controls:
# BATCH_REANALYZE_REVIEW_BATCH_SIZE=5
# BATCH_REANALYZE_AUDIT=1
# BATCH_REANALYZE_AUDIT_BATCH_SIZE=30
# BATCH_REANALYZE_REFEED_TIMEOUT_MS=90000
# BATCH_REANALYZE_AUDIT_MAX_REPORT_ISSUES=200
# Ollama debug logs (set to 1/true to print prompt/response previews + timings)
# OLLAMA_DEBUG=0
# Max characters printed for prompt/response previews (default: 500)
# OLLAMA_DEBUG_MAX_CHARS=500
# Max concurrent generate calls (default: 1)
# OLLAMA_MAX_CONCURRENT_GENERATE=1
# Consecutive /api/generate failures before temporary cooldown (default: 2)
# OLLAMA_GENERATE_FAILURE_THRESHOLD=2
# Cooldown duration after repeated generate failures in ms (default: 30000)
# OLLAMA_GENERATE_FAILURE_COOLDOWN_MS=30000

# Audio analysis process concurrency (default: 1, recommended for stability)
# AUDIO_ANALYSIS_MAX_CONCURRENT=1

# Downloader tool installation controls
# Build-time (requires docker compose build/up --build):
# INSTALL_YTDLP=1   # Include yt-dlp in the backend image
# INSTALL_SPOTDL=1  # Include spotdl in the backend image
#
# Runtime lazy install (on first use):
# AUTO_INSTALL_DOWNLOAD_TOOLS=0
# AUTO_INSTALL_YTDLP=0
# AUTO_INSTALL_SPOTDL=0
#
# Hard disable Spotify import path (runtime):
# ENABLE_SPOTIFY_IMPORT=1
#
# Frontend build flags (requires rebuild):
# VITE_ENABLE_SPOTIFY_IMPORT=1  # Optional override; docker-compose maps ENABLE_SPOTIFY_IMPORT into this by default
# VITE_SHOW_DOWNLOAD_TOOLS_UI=0
# VITE_STRIPE_DONATION_URL=https://donate.stripe.com/your-payment-link
