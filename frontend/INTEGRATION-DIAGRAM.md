# Backend Integration - Visual Guide

## ğŸŒ Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DEVELOPMENT MODE                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Web Browser                          Electron Window           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ localhost:3000   â”‚                â”‚ localhost:3000   â”‚      â”‚
â”‚  â”‚                  â”‚                â”‚  (loaded in app)  â”‚      â”‚
â”‚  â”‚  React App       â”‚                â”‚   React App      â”‚      â”‚
â”‚  â”‚  + Vite Proxy    â”‚                â”‚   + Vite Proxy   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚           â”‚                                    â”‚                 â”‚
â”‚           â”‚  /api â†’ http://localhost:4000     â”‚                 â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                â”‚                                 â”‚
â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚                         â”‚   Backend   â”‚                         â”‚
â”‚                         â”‚  Port 4000  â”‚                         â”‚
â”‚                         â”‚             â”‚                         â”‚
â”‚                         â”‚ Node.js API â”‚                         â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                                  â”‚
â”‚  âœ… Works automatically - no configuration needed               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PRODUCTION MODE - WEB                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Browser                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                           â”‚
â”‚  â”‚ your-domain.com  â”‚                                           â”‚
â”‚  â”‚                  â”‚                                           â”‚
â”‚  â”‚  React App       â”‚                                           â”‚
â”‚  â”‚  (static files)  â”‚                                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                           â”‚
â”‚           â”‚                                                      â”‚
â”‚           â”‚  /api requests                                      â”‚
â”‚           â”‚                                                      â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                     â”‚
â”‚    â”‚   Nginx/Apache      â”‚                                     â”‚
â”‚    â”‚  Reverse Proxy      â”‚                                     â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚
â”‚           â”‚                                                      â”‚
â”‚           â”‚  Proxy to backend                                   â”‚
â”‚           â”‚                                                      â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚    â”‚   Backend   â”‚                                             â”‚
â”‚    â”‚  Port 4000  â”‚                                             â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â”‚                                                                  â”‚
â”‚  Standard web deployment                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PRODUCTION MODE - ELECTRON (Option A)               â”‚
â”‚                    Separate Backend Process                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Electron App (.AppImage / .exe)                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚                                  â”‚                          â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                          â”‚
â”‚  â”‚  â”‚  React App                 â”‚  â”‚                          â”‚
â”‚  â”‚  â”‚  (bundled static files)    â”‚  â”‚                          â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                          â”‚
â”‚  â”‚               â”‚                   â”‚                          â”‚
â”‚  â”‚               â”‚ API calls         â”‚                          â”‚
â”‚  â”‚               â”‚                   â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                  â”‚                                               â”‚
â”‚                  â”‚ http://localhost:4000/api                    â”‚
â”‚                  â”‚ (or custom URL from settings)                â”‚
â”‚                  â”‚                                               â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚           â”‚   Backend   â”‚  â† User must start separately        â”‚
â”‚           â”‚  Port 4000  â”‚                                       â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚                                                                  â”‚
â”‚  âš™ï¸ Configurable via Settings â†’ Backend Server                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PRODUCTION MODE - ELECTRON (Option B)               â”‚
â”‚                      Embedded Backend                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Electron App (.AppImage / .exe)                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚  â”‚
â”‚  â”‚  â”‚  React App                 â”‚                          â”‚  â”‚
â”‚  â”‚  â”‚  (bundled static files)    â”‚                          â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚  â”‚
â”‚  â”‚               â”‚                                            â”‚  â”‚
â”‚  â”‚               â”‚ API calls                                  â”‚  â”‚
â”‚  â”‚               â”‚                                            â”‚  â”‚
â”‚  â”‚               â”‚ http://localhost:4000/api                 â”‚  â”‚
â”‚  â”‚               â”‚                                            â”‚  â”‚
â”‚  â”‚        â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                                    â”‚  â”‚
â”‚  â”‚        â”‚   Backend   â”‚  â† Started by Electron             â”‚  â”‚
â”‚  â”‚        â”‚  (embedded) â”‚    on app launch                   â”‚  â”‚
â”‚  â”‚        â”‚             â”‚                                     â”‚  â”‚
â”‚  â”‚        â”‚ Child Processâ”‚                                    â”‚  â”‚
â”‚  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  âœ… Truly standalone - no manual setup required                â”‚
â”‚  ğŸ“¦ Backend bundled in app package                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Request Flow

### Development (Web & Electron)
```
React Component
  â†“
api.get('/tracks')
  â†“
axios({ baseURL: '/api' })
  â†“
Vite Dev Server Proxy
  â†“
http://localhost:4000/api/tracks
  â†“
Backend Handler
```

### Production Electron (with dynamic URL)
```
React Component
  â†“
api.get('/tracks')
  â†“
axios({ baseURL: getApiBaseUrl() })
  â†“
getApiBaseUrl() returns:
  - localStorage.getItem('apiBaseUrl') (if custom)
  - OR 'http://localhost:4000/api' (default)
  â†“
http://localhost:4000/api/tracks
  â†“
Backend Handler
```

## ğŸ› ï¸ Configuration Flow

```
User opens Settings
  â†“
<ApiSettings /> component (Electron only)
  â†“
User enters custom URL: http://192.168.1.100:4000/api
  â†“
Clicks "Test Connection"
  â†“
fetch(`${url}/auth/status`)
  â†“
âœ… Success â†’ User clicks "Save & Reload"
  â†“
localStorage.setItem('apiBaseUrl', url)
  â†“
window.location.reload()
  â†“
All API calls now use new URL
```

## ğŸ“‚ File Structure

```
sample_solution/
â”œâ”€â”€ backend/                    # Backend server
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â””â”€â”€ index.js           # Express server (port 4000)
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ frontend/
    â”œâ”€â”€ electron/              # Electron main process
    â”‚   â”œâ”€â”€ main.js           # Can start embedded backend
    â”‚   â””â”€â”€ preload.js
    â”‚
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ api/
    â”‚   â”‚   â””â”€â”€ client.ts     # âœ… UPDATED: Uses getApiBaseUrl()
    â”‚   â”‚
    â”‚   â”œâ”€â”€ utils/
    â”‚   â”‚   â”œâ”€â”€ api-config.ts # âœ… NEW: Dynamic URL configuration
    â”‚   â”‚   â”œâ”€â”€ platform.ts   # âœ… NEW: Electron detection
    â”‚   â”‚   â””â”€â”€ webgl-check.ts
    â”‚   â”‚
    â”‚   â””â”€â”€ components/
    â”‚       â”œâ”€â”€ ApiSettings.tsx # âœ… NEW: Backend URL settings
    â”‚       â””â”€â”€ DebugPanel.tsx
    â”‚
    â”œâ”€â”€ vite.config.ts         # Proxy: /api â†’ localhost:4000
    â””â”€â”€ package.json           # Electron scripts & build config
```

## âœ… What Works Now

| Scenario | Status | Configuration |
|----------|--------|---------------|
| **Web Dev** | âœ… Works | Vite proxy automatic |
| **Electron Dev** | âœ… Works | Same Vite proxy |
| **Web Prod** | âœ… Works | Nginx/Apache proxy |
| **Electron Prod** | âš™ï¸ Ready | Need to start backend OR embed it |

## ğŸ¯ Quick Test

### Test Current Setup (Dev Mode)

**Terminal 1:**
```bash
cd backend
npm start  # Starts on port 4000
```

**Terminal 2:**
```bash
cd frontend
npm run dev:electron  # Works with backend on 4000
```

**Or Web:**
```bash
cd frontend
npm run dev  # Also works with backend on 4000
```

### Test Production Electron

**Build and run:**
```bash
# Backend must be running
cd backend && npm start &

# Build Electron app
cd frontend
npm run build:electron

# Run built app
./release/Sample-Extractor*.AppImage
```

The app will connect to `http://localhost:4000/api` by default.

To change the backend URL:
1. Open the app
2. Go to Settings
3. Find "Backend Server" section
4. Enter custom URL
5. Click "Test Connection" then "Save & Reload"

---

**Need embedded backend?** See [BACKEND-INTEGRATION.md](BACKEND-INTEGRATION.md) Option B.
